<!DOCTYPE html>
<html>
	<head>
		<title>Geohackers</title>
		<script src="babylon.2.3.js"></script>
		<style>
		html, body {
			overflow: hidden;
			width   : 100%;
			height  : 100%;
			margin  : 0;
			padding : 0;
		}

		#renderCanvas {
			width   : 100%;
			height  : 100%;
			touch-action: none;
		}
		</style>
	</head>
	<body>
	    <script type="application/vertexShader" id="vertexShaderCode">
	        precision highp float;

	        attribute vec3 position;
	        attribute vec3 normal;
	        attribute vec2 uv;

	        uniform mat4 worldViewProjection;
	        uniform mat4 worldView;
	        uniform vec3 light0position;
	        uniform float time;

			varying vec3 vPosition;
			varying vec3 vNormal;
			varying vec2 vUV;
			varying vec3 vLightPosition;

	        void main(void) {
	        	vec4 t = vec4(position, 1.0);
	        	t.y += sin(uv.x * 23.1 + 2.0 * time) * 4.0;
	        	t.y += sin(uv.y * 33.1 + 4.0 * time) * 6.0;
	        	t.y += cos(uv.x * 32.5 + 3.0 * time) * 4.0;
	        	t.y += cos(uv.y * 23.1 + 1.0 * time) * 6.0;

			    vec4 outPosition = worldViewProjection * t;
			    gl_Position = outPosition;

			    vUV = uv;
			    vPosition = position;
			    vNormal = normal;
			    vLightPosition = light0position - position;
	        }
	    </script>

	    <script type="application/fragmentShader" id="fragmentShaderCode">
	        precision highp float;

	        uniform sampler2D diffuseTexture;

			uniform vec3 cameraPosition;

			uniform mat4 world;

			varying vec3 vPosition;
			varying vec3 vNormal;
			varying vec2 vUV;
			varying vec3 vLightPosition;

	        void main(void) {
			    // World values
			    vec3 vPositionW = vec3(world * vec4(vPosition, 1.0));
			    vec3 vNormalW = normalize(vec3(world * vec4(vNormal, 0.0)));
			    vec3 viewDirectionW = normalize(cameraPosition - vPositionW);

			    // Light
			    vec3 lightVectorW = normalize(vLightPosition - vPositionW);
			    vec3 color = texture2D(diffuseTexture, vUV).rgb;
			    // color  = vec3(1,0,0);

			    // diffuse
			    float ndl = max(0.2, dot(vNormalW, lightVectorW));

			    // Specular
			    vec3 angleW = normalize(viewDirectionW + lightVectorW);
			    float specComp = max(0., dot(vNormalW, angleW));
			    specComp = pow(specComp, max(1., 64.)) * 2.;

			    gl_FragColor = vec4(color * ndl + vec3(specComp), 1.);

			    /*
	        	vec3 L = (light0position - vPos);
   				// vec4 Idiff = gl_FrontLightProduct[0].diffuse * max(dot(N,L), 0.0);
				// Idiff = clamp(Idiff, 0.0, 1.0);

    	    	gl_FragColor = vec4(0.5,0.5,0.5,1.0) + vec4(L, 1.0);// vec4(1, vUV.x, vUV.y, 1) * texture2D(diffuseTexture, vUV);
				*/
	        }
	    </script>
		<canvas id="renderCanvas"></canvas>
		<pre id="taag_output_text" style="float:left;" class="fig" contenteditable="true">
		   _____            _                _
		  / ____|          | |              | |
		 | |  __  ___  ___ | |__   __ _  ___| | _____ _ __ ___
		 | | |_ |/ _ \/ _ \| '_ \ / _` |/ __| |/ / _ \ '__/ __|
		 | |__| |  __/ (_) | | | | (_| | (__|   &lt;  __/ |  \__ \
		  \_____|\___|\___/|_| |_|\__,_|\___|_|\_\___|_|  |___/
		</pre>
		<script src="app2.js"></script>
	</body>
</html>